<!DOCTYPE html>
<html>
<body>
    <input type="text" id="inputURL" placeholder="Enter image URL" />
    <button onclick="loadImage()">Load Image</button>
    <canvas id="myCanvas"></canvas>

    <script>
        const canvas = document.getElementById('myCanvas');
        const context = canvas.getContext('2d');
        const grid_size = 50;
        let grid = [];

        document.getElementById('inputURL').addEventListener('input', loadImage);

        function loadImage() {
            const url = document.getElementById('inputURL').value;
            const img = new Image();
            img.crossOrigin = "Anonymous"; // This enables CORS
            img.onload = function() {
                canvas.width = img.width;
                canvas.height = img.height;
                console.log('canvas.width', canvas.width);
                console.log('canvas.height', canvas.height);
                console.log('grid_size', grid_size);
                context.drawImage(img, 0, 0);
                drawGrid();
                grid = new Array(Math.ceil(canvas.width / grid_size)).fill(0).map(() => new Array(Math.ceil(canvas.height / grid_size)).fill(false));
                // Enable the click event
                canvas.addEventListener('click', revealSquare);
            }
            img.src = url;
        }

canvas.addEventListener('click', function(evt) {
    // Check if the grid array has been created
    if (!grid) {
        return;
    }
    const x = evt.layerX - (evt.layerX % grid_size);
    const y = evt.layerY - (evt.layerY % grid_size);
    if (!grid[x / grid_size][y / grid_size]) {
        context.clearRect(x, y, grid_size, grid_size);
        grid[x / grid_size][y / grid_size] = true;
    }
});


        canvas.addEventListener('click', function(evt) {
            const x = evt.layerX - (evt.layerX % grid_size);
            const y = evt.layerY - (evt.layerY % grid_size);
            if (!grid[x / grid_size][y / grid_size]) {
                context.clearRect(x, y, grid_size, grid_size);
                grid[x / grid_size][y / grid_size] = true;
            }
        });

        function drawGrid() {
            context.fillStyle = 'white';
            context.fillRect(0, 0, canvas.width, canvas.height);
            context.strokeStyle = 'black';
            for (let i = 0; i < canvas.width; i += grid_size) {
                for (let j = 0; j < canvas.height; j += grid_size) {
                    context.strokeRect(i, j, grid_size, grid_size);
                }
            }
        }
    </script>
</body>
</html>
